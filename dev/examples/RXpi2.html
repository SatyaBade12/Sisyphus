<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Rₓ(π/2) · Sisyphus.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">Sisyphus.jl</a></span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><a class="tocitem" href="../installation.html">Installation</a></li><li><a class="tocitem" href="../introduction.html">Introduction</a></li><li><a class="tocitem" href="../gbqoc.html">Gradient-based QOC</a></li><li><a class="tocitem" href="../noisy.html">Open quantum systems</a></li><li><a class="tocitem" href="../tutorial.html">Tutorial</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="DRAG.html">DRAG</a></li><li><a class="tocitem" href="TwoLevelSystem.html">Two-level system</a></li><li><a class="tocitem" href="TwoLevelSystemNoisy.html">Noisy two-level system</a></li><li class="is-active"><a class="tocitem" href="RXpi2.html">Rₓ(π/2)</a></li><li><a class="tocitem" href="SQRTiSWAP.html">√iSWAP</a></li><li><a class="tocitem" href="CZ2.html">CZ</a></li><li><a class="tocitem" href="GHZState.html">GHZ state</a></li><li><a class="tocitem" href="GHZStateCUDANeuralNetwork.html">GHZ state 12 atoms (CUDA)</a></li><li><a class="tocitem" href="GHZStateCUDALinearInterp.html">GHZ state 16 atoms (CUDA)</a></li></ul></li><li><a class="tocitem" href="../api.html">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="RXpi2.html">Rₓ(π/2)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="RXpi2.html">Rₓ(π/2)</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SatyaBade12/Sisyphus.jl/blob/main/docs/src/examples/RXpi2.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="R_x(\\pi/2)-gate"><a class="docs-heading-anchor" href="#R_x(\\pi/2)-gate"><span>$R_x(\pi/2)$</span> gate</a><a id="R_x(\\pi/2)-gate-1"></a><a class="docs-heading-anchor-permalink" href="#R_x(\\pi/2)-gate" title="Permalink"></a></h1><pre><code class="language-julia hljs">using Sisyphus
using QuantumOptics
using Flux, DiffEqFlux
using Plots
using Random
using ProgressMeter

ProgressMeter.ijulia_behavior(:clear)</code></pre><p>A transmon is a Josephson junction (non linear inductor) shunted with a capacitor. The quantum mechanical Hamiltonian of such a system often referred to as a Cooper pair box is given,</p><p class="math-container">\[ H = 4 E_c (n - n_g)^2 - E_J \cos\varphi,\]</p><p>where <span>$n$</span> and <span>$\varphi$</span> are the Cooper pair number and phase conjugate variables, <span>$n_g$</span> is charge bias, <span>$E_J$</span> and <span>$E_c$</span> denote the Josephson and charging energies respectively.  The non linear nature of the Josephson junction makes the transmon an anharmonic oscillator, effectively isolating the first two levels from the remaining levels to realize a qubit (i.e. <span>$\omega_{01}\neq \omega_{12}$</span>). The evolution of transmons is modelled with a generalized Duffing Oscillator resulting from the expansion of Cooper pair box Hamiltonian,</p><p class="math-container">\[H_{DO_K} = \omega_0 \left(a^{\dagger}a + \frac{1}{2}\right) +\frac{\omega_0^2}{8\eta} \sum_{k=2}^{K} \left(\frac{4\eta}{\omega_0}\right)^{k}\frac{(-1)^k (a^{\dagger} + a)^{2k}}{(2k)!} +  i f(t)\cos[\omega&#39;(t)t + \phi(t)](a - a^{\dagger}), \]</p><p>where <span>$\omega_0$</span> is the qubit frequency, <span>$\eta$</span> is the anharmonicity (note that <span>$\omega_{01} \approx \omega_0 + \eta$</span>), <span>$f(t)$</span> is the slow varying envelope of the RF drive. The microwave frequency <span>$\omega&#39;$</span> is typically in the <span>$GHz$</span> range and therefore it is generated by mixing a low frequency signal of few <span>$MHz$</span> with a local oscillator <span>$\omega&#39; = \omega_{LO} + \omega_{IF}$</span>. The <span>$I$</span> and <span>$Q$</span> quadratures of slow varying envelope,</p><p class="math-container">\[[I(t), Q(t)] = [f(t)\cos(\phi(t)), f(t) \sin(\phi(t))].\]</p><p>Jones <em>et al.</em>  argue that for typical transmon parameters, sextic terms (<span>$K=3$</span>) are enough to match the spectrum of the Cooper pair box Hamiltonian (<span>$K=\infty$</span>). In general, the minimum number of levels and expansion order needed to accurately model the dynamics depends on the anharmonicity, strength of the drive etc. these parameters have to be chosen based on the desired accuracy, for e.g. by monitoring the occupation probabilities of lower energy levels.</p><p>In this notebook we show how to design smooth 4 ns pulses to do a <span>$R_x(\pi/2)$</span> gate, by including the first 12 levels of a transmon, in a few minutes! (simulations are done in the lab frame)</p><pre><code class="language-julia hljs">ω₀ = 2π*5.0
η = -2π*300*1e-3
ωlo = ω₀</code></pre><pre><code class="nohighlight hljs">31.41592653589793</code></pre><pre><code class="language-julia hljs">n_levels = 12
bs = FockBasis(n_levels-1)
a = destroy(bs)
ad = create(bs)
id = identityoperator(bs, bs)</code></pre><pre><code class="language-julia hljs">H0 = ω₀*(ad*a + 0.5*id) + (η/12.0)*(a + ad)^4 - η^2 * (a + ad)^6/ω₀/90.0
H1 = 1.0im*(a - ad)</code></pre><p>we parametrize the waveforms using a neural network with one input (<span>$t$</span>) and two outputs (<span>$I(t)$</span> and <span>$Q(t)$</span>), we then train the neural network to produce DRAG pulse like waveforms</p><pre><code class="language-julia hljs">n_neurons = 8
Random.seed!(1)
ann = FastChain(FastDense(1, n_neurons, tanh), 
                FastDense(n_neurons, n_neurons, tanh),
                FastDense(n_neurons, 2))
t0, t1 = 0.0, 4.0

I_guess(t) = @. -2π*exp(-(t-0.5*t1)^2/(0.2*t1)^2)*2.0*(t-0.5*t1) /(0.2*t1)^2
Q_guess(t) = @. -2π*exp(-(t-0.5*t1)^2/(0.2*t1)^2)

tsf32 = Float32(t0):0.001f0:Float32(t1)
Is = Vector{Float32}(I_guess(tsf32))
Qs = Vector{Float32}(Q_guess(tsf32))

ts = Vector{Float64}(tsf32)
function loss(p)
    c = 0.0f0
    for (i,t) in enumerate(tsf32)
        x = ann([t], p)
        c += (x[1] - Is[i])^2
        c += (x[2] - Qs[i])^2
    end
    c
end
res = DiffEqFlux.sciml_train(loss, initial_params(ann), ADAM(0.1f0), maxiters = 500)
θ = Vector{Float64}(res.u)</code></pre><p>time dependant drive after mixing with local oscillator</p><pre><code class="language-julia hljs">coeffs(params, t) = let b = ann([t], params)
                        [b[1]*cos(ωlo*t) + b[2]*sin(ωlo*t)]
                    end</code></pre><pre><code class="nohighlight hljs">coeffs (generic function with 1 method)</code></pre><p>we specify the objective to optimize, first argument includes the infidelity and the second one takes the constraints on the waveforms, here we simply pin <span>$I$</span> and <span>$Q$</span> to be zero at <span>$t_0$</span> and <span>$t_1$</span></p><pre><code class="language-julia hljs">bcs(params) = 0.01*sum(ann([t0], params).^2 + ann([t1], params).^2)
                 
cost = CostFunction((x,y)-&gt; 1.0-real(x&#39;*y), bcs)</code></pre><pre><code class="nohighlight hljs">CostFunction(var&quot;#1#2&quot;(), bcs)</code></pre><p>Unitary transformation denoting <span>$R_x(\pi/2)$</span> gate</p><pre><code class="language-julia hljs">trans = UnitaryTransform([fockstate(bs, 0), fockstate(bs, 1)], 
                         [[1.0 -1.0im];[-1.0im 1.0]]/√2)</code></pre><p>Hamiltonian of the problem</p><pre><code class="language-julia hljs">H = Hamiltonian(H0, [H1], coeffs)</code></pre><p>QOCProblem definition</p><pre><code class="language-julia hljs">prob = QOCProblem(H, trans, (t0, t1), cost)</code></pre><p>we use the DRAG like pulses as an initial guess and solve the problem</p><pre><code class="language-julia hljs">@time sol = solve(prob, θ, ADAM(0.02); maxiter=100)</code></pre><pre><code class="nohighlight hljs">[32mProgress: 100%|█████████████████████████████████████████| Time: 0:02:34[39m
[34m  distance:     0.00487591354733552[39m
[34m  constraints:  7.803988353750598e-5[39m


171.865075 seconds (664.66 M allocations: 62.231 GiB, 23.89% gc time, 20.43% compilation time)</code></pre><pre><code class="language-julia hljs">plot(sol.distance_trace, label=&quot;infidelity&quot;)
plot!(sol.constraints_trace, label=&quot;constraints&quot;)</code></pre><p><img src="RXpi2_files/RXpi2_20_0.svg" alt="svg"/></p><pre><code class="language-julia hljs">I_wf(t) = ann([t], sol.params)[1]/2π
Q_wf(t) = ann([t], sol.params)[2]/2π</code></pre><pre><code class="nohighlight hljs">Q_wf (generic function with 1 method)</code></pre><pre><code class="language-julia hljs">plot(ts, I_wf.(ts), label=&quot;I&quot;)
plot!(ts, Q_wf.(ts), label=&quot;Q&quot;)
xlabel!(&quot;Time (ns)&quot;)
ylabel!(&quot;Frequency (GHz)&quot;)</code></pre><p><img src="RXpi2_files/RXpi2_22_0.svg" alt="svg"/></p><pre><code class="language-julia hljs">tout, psit = schroedinger_dynamic(ts, fockstate(bs, 0), H, sol.params)</code></pre><pre><code class="language-julia hljs">f = plot()
for i in 0:11
    plot!(f, ts, real(expect(dm(fockstate(bs, i)), psit)),
          label=&quot;|&quot;*string(i)*&quot;⟩&quot;, legend=:left)
end
xlabel!(f, &quot;Time (ns)&quot;)
ylabel!(f, &quot;Population (⟨i|ψ⟩²)&quot;)
f</code></pre><p><img src="RXpi2_files/RXpi2_24_0.svg" alt="svg"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="TwoLevelSystemNoisy.html">« Noisy two-level system</a><a class="docs-footer-nextpage" href="SQRTiSWAP.html">√iSWAP »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Monday 19 June 2023 19:54">Monday 19 June 2023</span>. Using Julia version 1.9.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
